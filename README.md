# Trojan Go with Traefik and Wrap

## Usage

First, two networks are required:

- `frontend`: used for communication with Traefik.
- `warp_network`: used for communication with Warp.

### Configuring docker-compose

Begin by assigning a domain to trojan-go. Modify the `DOMAIN` variable in the `.env` file.

Next, configure Traefik's entry point, which should correspond to port 443. Here, I'm using the `web_secure` entry point, as configured in `traefik.yml`.

```yaml
services:
  trojan:
    ...
    labels:
      - traefik.enable=true
      - "traefik.tcp.routers.trojan-go.entrypoints=web_secure"
    ...
```

### Configuring trojan-go

Rename `trojan.example.json` to `trojan.json` and edit its information.

`remote_addr` and `remote_port` can be configured for other services under Traefik. If none are available, a Caddy service can be added in docker-compose to display a static webpage, then configured as `caddy` and `443`.

Configure certificates, which can be generated by Traefik or manually. Here, I'm using certificates generated by Traefik, exported periodically via a third-party tool and configured in `trojan.json`. Certificate paths are mapped in `docker-compose.yml`.

Specify the exit using `forward_proxy`:

```json
{
    "run_type": "server",
    "local_addr": "0.0.0.0",
    "local_port": 443,
    "remote_addr": "one-api",
    "remote_port": 3000,
    "password": [
        "your password"
    ],
    "ssl": {
        "cert": "/certs/cert.pem",
        "key": "/certs/privkey.pem",
        "sni":"your domian"
    },
    "forward_proxy": {
        "enabled": true,
        "proxy_addr": "warp-socks",
        "proxy_port": 9091
      }
}
```
